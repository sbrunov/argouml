r3076 branches/work_refactoringmodelchanged_jaap